this is the source code of preprocess
